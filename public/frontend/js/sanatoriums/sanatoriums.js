function transferSetDirectionLabels(){var a=$("#inp_tra_g1 option:selected").is('[data-type="city"]'),b=$("#inp_tra_g2 option:selected").is('[data-type="city"]'),c="trans";a!==b&&(c=a?"out":"in"),$("label[data-type]").hide(),$('label[data-type="'+c+'"]').show()}$(document).ready(function(){if($("#datesSummary a").click(function(){return $("#datesForm").removeClass("hidden"),$("#datesSummary").remove(),$("#rooms").remove(),!1}),void 0!=window.alternative_terms_start&&void 0!=window.alternative_terms_link){var a=function(a,b){$("#alternativeLoading").show(),$("#alternativeResult").hide();var c=window.alternative_terms_link+"&"+a+"="+window.alternative_terms_start;b&&(c=c+"&actual="+b),$.getJSON(c,function(a){0!=a?(window.alternative_terms_start=a.alternative.arrival,$('[data-alternative="arrival"]').text(a.alternative.arrival_text),$('[data-alternative="departure"]').text(a.alternative.departure_text),$('[data-alternative="submit"]').attr("href",a.alternative.link+"#anch"),void 0!=a.prev?$('a[data-alternative="prev"]').attr("data-date",a.prev).show():$('a[data-alternative="prev"]').hide(),void 0!=a.next?$('a[data-alternative="next"]').attr("data-date",a.next).show():$('a[data-alternative="next"]').hide(),$("#alternativeLoading").hide(),$("#alternativeResult").show()):$("#alternativeContainer").hide()})};$('a[data-alternative="prev"], a[data-alternative="next"]').click(function(){return a($(this).attr("data-alternative"),$(this).attr("data-date")),!1}),a("next")}}),$(document).ready(function(){$("#langMenu span").on("click",function(){$("#langMenu ul").toggle()}),$('[data-action="datepicker_icon"]').click(function(){$(this).closest("fieldset").find(".hasDatepicker").datepicker("show")}),$('select[data-action="phone-prefix-selector"]').on("change",function(){$("#phonePrefix").text($(this).find("option:selected").attr("data-prefix"))}).trigger("change"),$('form[data-form="one_send"]').submit(function(){$(this).submit(function(){return!1})})});var callByName=function(a,b){if(a.indexOf(".")>0){var c=a.split("."),d=window[c[0]];d&&d[c[1]]&&d[c[1]](b)}else window[a](b)},date_operations=new function(){this.min_stay=0,this._init=function(){this.min_stay=window.searchform_min_stay},this._getContrainer=function(a){return $(a).closest('[data-action="date_container"]')},this._toString=function(a){return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+(a.getDate()<10?"0":"")+a.getDate()},this.resetDays=function(a){var b=this._getContrainer(a),c=$(a).val().replace(/\-/g,"/"),d=new Date(c+"/01");d.setMonth(d.getMonth()+1),d.setDate(d.getDate()-1);var e=d.getDate();""==$(a).val()&&e++;var f=$(b).find('[data-action="date_day"]'),g=$(f).val();$(f).find('option[value!=""]').remove();for(var h=1;e>=h;h++)$(f).append('<option value="'+(10>h?"0":"")+h+'">'+h+"</option>");$(f).val(g&&$(f).find('option[value="'+g+'"]').length>0?g:$(f).find("option:last").val())},this.selectChanged=function(a){var b=this._getContrainer(a);if(""==$(b).find('[data-action="date_month"]').val())return!1;var c=$(b).find('[data-action="date_day"]').val();(""==c||void 0==c)&&(c="01");var d=$(b).find('[data-action="date_month"]').val()+"-"+c,e=$(b).find('input[data-action="datepicker"]');$(e).datepicker("setDate",d),this.datepickerChanged(e)},this.datepickerChanged=function(a){var b=$(a).val();if(""==b||void 0==b)return!1;var c=this._getContrainer(a);$(c).find('[data-action="date_day"]').val(b.substr(8,9));var d=$(c).find('[data-action="date_month"]'),e=$(d).val(),f=b.substr(0,7);$(d).val(f),e!=f&&this.resetDays(d),this.checkDates(a)},this.checkDates=function(a){var b=this._getContrainer(a),c=$(b).attr("data-type"),d=_getSearchForm(a),e=$(d).find('[data-action="date_container"][data-type="arrival"]'),f=$(d).find('[data-action="date_container"][data-type="departure"]'),g=$(e).find('[data-action="datepicker"]').val().replace(/\-/g,"/"),h=$(f).find('[data-action="datepicker"]').val().replace(/\-/g,"/"),i=new Date(g),j=new Date(h);switch(c){case"arrival":if(!i.getTime())return!1;if(i.setDate(i.getDate()+this.min_stay),j.getTime()&&j>=i)return;var k=$(f).find('input[data-action="datepicker"]');$(k).datepicker("setDate",i),this.datepickerChanged(k);break;case"departure":if(!j.getTime())return!1;if(j.setDate(j.getDate()-this.min_stay),i.getTime()&&j>=i)return;{var l=$(e).find('input[data-action="datepicker"]');$(f).find('input[data-action="datepicker"]')}$(l).datepicker("setDate",j),this.datepickerChanged(l)}}};$(document).ready(function(){date_operations._init(),$('[data-action="date_container"][data-type="arrival"] [data-action="datepicker"]').datepicker({dateFormat:"yy-mm-dd",minDate:0,maxDate:"+1y",onClose:function(){date_operations.datepickerChanged(this)}}),$('[data-action="date_container"][data-type="departure"] [data-action="datepicker"]').datepicker({dateFormat:"yy-mm-dd",minDate:"+"+date_operations.min_stay+"d",maxDate:"+1y",onClose:function(){date_operations.datepickerChanged(this)}}),$('select[data-action="date_day"]').on("change",function(){date_operations.selectChanged(this)}),$('select[data-action="date_month"]').on("change",function(){date_operations.resetDays(this),date_operations.selectChanged(this)}),$('form[data-action="search_form"] input[data-action="datepicker"]').each(function(){date_operations.datepickerChanged(this)})});var filter_operations=new function(){this._max_items=5,this._speed=300,this._timeout=null,this._init=function(){this._max_items=window.searchfilter_max_items},this._getContainer=function(a){return $(a).is('[data-action="filter_container"]')?a:$(a).closest('[data-action="filter_container"]')},this.hide_items=function(a,b){var c=this._getContainer(a),d=$(c).find("fieldset").length,e=$(c).find("fieldset:has(input:checked):last"),f=$(c).find("fieldset").index(e),g=b===!0?0:this._speed;if(d>this._max_items){var h=$(c).find("fieldset:gt("+Math.max(f,this._max_items-1)+")");h.length>0&&($(h).slideUp(g),$(c).find("a.less").addClass("hidden"),$(c).find("a.more").removeClass("hidden"))}},this.show_items=function(a){var b=this._getContainer(a),c=$(b).find("fieldset:hidden");c.length>0&&($(c).slideDown(this._speed),$(b).find("a.less").removeClass("hidden"),$(b).find("a.more").addClass("hidden"))},this.send_request=function(){window.clearTimeout(this._timeout),this._timeout=window.setTimeout("filter_operations._request();",500)},this.get_url=function(){var a="",b={};$("[data-filter] ").each(function(a,c){var d=$(c).attr("data-filter");void 0==b[d]&&(b[d]=""),$(c).find("input:checkbox:checked").each(function(a,c){b[d]=b[d]+$(c).val()+","})});for(f in b)""!=b[f]&&(a=a+"&"+f+"="+b[f].substr(0,b[f].length-1));return a},this._request=function(){search_functions.reload_results()}};$(document).ready(function(){filter_operations._init(),$("#results div.filter").each(function(a,b){filter_operations.hide_items(b,!0)}),$('[data-action="filter_container"] a.more').click(function(){return filter_operations.show_items(this),!1}),$('[data-action="filter_container"] a.less').click(function(){return filter_operations.hide_items(this,!1),!1}),$("[data-filter] input:checkbox").change(function(){var a=$(this).next("label");$(this).is(":checked")?$(a).addClass("checked"):$(a).removeClass("checked remove"),filter_operations.send_request()}),$("[data-filter] label").mouseover(function(){$(this).is(".checked")&&$(this).addClass("remove")}).mouseout(function(){$(this).removeClass("remove")})});var _getSearchForm=function(a){return $(a).closest('[data-action="search_form"]')},search_functions=new function(){this.reload_results=function(a){$("#resultsLoading").fadeIn(100),$("html, body").animate({scrollTop:0},"slow"),url=window.filter_base_url+filter_operations.get_url(),url=url+"&so="+$('ul[data-action="ax_sort"] li.active').attr("data-sort"),void 0!=a&&""!=a&&(url+="&"+a),void 0!=window.history.pushState?(window.history.pushState("","",url),$("#resultsContent").load(url+"&ax=1",null,function(){FloatTip.init(),$("#resultsLoading").fadeOut(100)})):window.location.href=url}};$(document).ready(function(){if($('[data-action="search_form"] [data-action="search_text_clear"]').on("click",function(){var a=$(this).prevAll("input");$(a).val("").focus(),$(this).fadeOut(200)}),$("#searchBasic[data-phrase]").length>0){var a=$("#searchBasic").attr("data-phrase"),b=new RegExp("("+a+")","gi");$("#searchBasic .item").each(function(a,c){var d=$(c).find("h3 > a").text();$(c).find("h3 > a").html(d.replace(b,'<em class="highlight">$1</b>'))})}$("#results").on("click",'[data-action="ax_sort"] a',function(){var a=$(this).closest("ul");return a.children("li").removeClass("active"),$(this).closest("li").addClass("active"),search_functions.reload_results(),!1}),$("#results").on("click",'[data-action="ax_page"] a',function(){var a=$(this).closest("li").attr("data-page");return search_functions.reload_results("pg="+a),!1}),$("#results").on("click",'[data-action="search-form-toggler"]',function(){return $(this).closest('[data-action="search-form-container"]').find('[data-action="search-form"]').toggleClass("hidden"),!1})});var room_operations=new function(){this.max_adults=4,this.max_children=4,this.max_age=15,this.services_adult=["fbt","hbt"],this.services_child=["fbt","fb","hbt","hb"],this._init=function(){this.max_age=window.searchform_max_age},this._getContainer=function(a){return $(a).closest('[data-action="search_container_rooms"]')},this._getRoom=function(a){return $(a).closest('[data-action="search_room"]')},this.makeAdult=function(a,b){void 0==a&&(a=1);var c='<fieldset><div class="service"><label>'+a+". "+window.searchform_lang.adult+'</label><div class="select_wrapper"><select name="ad['+b+'][]">';for(serv in this.services_adult)c+='<option value="'+this.services_adult[serv]+'">'+window.searchform_lang[this.services_adult[serv]]+"</option>";return c+="</select></div></div></fieldset>"},this.makeChild=function(a,b){void 0==a&&(a=1);var c='<fieldset><div class="service"><label>'+a+". "+window.searchform_lang.child+'</label><div class="select_wrapper"><select name="ch['+b+'][]">';for(serv in this.services_child)c+='<option value="'+this.services_child[serv]+'">'+window.searchform_lang[this.services_child[serv]]+"</option>";c+='</select></div></div><div class="age"><label>'+window.searchform_lang.age+'</label><div class="select_wrapper"><select name="age['+b+'][]">';for(var d=0;d<=this.max_age;d++)c+='<option value="'+d+'">'+d+"</option>";return c+="</select></div></div></fieldset>"},this.makeRoom=function(a){void 0==a&&(a=1);for(var b='<div class="room" data-action="search_room"><span class="title">'+window.searchform_lang.room+" "+a+'</span><div class="adults"><fieldset><label>'+window.searchform_lang.adults+'</label><div class="select_wrapper"><select data-action="search_count_adults">',c=1;c<=this.max_adults;c++)b+='<option value="'+c+'">'+c+"</option>";b+='</select></div></fieldset><div class="settings" data-action="search_container_adults"></div></div><div class="children"><fieldset><label>'+window.searchform_lang.children+'</label><div class="select_wrapper"><select data-action="search_count_children">';for(var c=0;c<=this.max_children;c++)b+='<option value="'+c+'">'+c+"</option>";return b+='</select></div></fieldset><div class="settings" data-action="search_container_children"></div></div></div>'},this.setAdults=function(a,b){var c=$(a).find('[data-action="search_container_adults"]'),d=$(a).find('select[data-action="search_count_adults"]').val(),e=$(c).find("fieldset").length;if(b||(b=$(a).index()),e>d)return void $(c).find("fieldset").slice(d).remove();if(d>e)for(var f,g=e+1;d>=g;g++)f=this.makeAdult(g,b),$(c).append(f)},this.setChildren=function(a,b){var c=$(a).find('[data-action="search_container_children"]'),d=$(a).find('select[data-action="search_count_children"]').val(),e=$(c).find("fieldset").length;if(b||(b=$(a).index()),e>d)return void $(c).find("fieldset").slice(d).remove();if(d>e)for(var f,g=e+1;d>=g;g++)f=this.makeChild(g,b),$(c).append(f)},this.setRooms=function(b,d){$(b).empty();for(r in d){if(room=$(room_operations.makeRoom(1*r+1)),void 0!==d[r].ad){adult_container=$(room).find('[data-action="search_container_adults"]'),$(room).find('select[data-action="search_count_adults"]').val(d[r].ad.length);for(a in d[r].ad)adult=$(this.makeAdult(1*a+1,r)),$(adult).find("select").val(d[r].ad[a]),$(adult_container).append(adult)}if(void 0!==d[r].ch){var e=$(room).find('[data-action="search_container_children"]');$(room).find('select[data-action="search_count_children"]').val(d[r].ch.length);for(c in d[r].ch)child=$(this.makeChild(1*c+1,r)),$(child).find('select[name^="ch["]').val(d[r].ch[c]),$(child).find('select[name^="age["]').val(d[r].age[c]),$(e).append(child)}b.append(room)}}};$(document).ready(function(){room_operations._init(),$('select[data-action="search_rooms"]').on("change",function(){var a=_getSearchForm(this),b=$(a).find('[data-action="search_container_rooms"]');if($(this).val()%100==0){var c=Math.floor($(this).val()/100),d=$(b).find(".room").length;if(d>c)return void $(b).find(".room").slice(c).remove();if(c>d)for(var e,f=d;c>f;f++)e=$(room_operations.makeRoom(f+1)),room_operations.setAdults(e,f),b.append(e);$(b).show(),$(a).find('[data-action="search_service"]').hide()}else $(b).find(".room").remove(),$(b).hide(),$(a).find('[data-action="search_service"]').show(),$(a).find('[data-action="search_container_toggler"]').hide()}),$('div[data-action="search_container_rooms"]').on("change",'[data-action^="search_count_"]',function(){var a=room_operations._getRoom(this);return $(this).is('[data-action$="adults"]')?void room_operations.setAdults(a):$(this).is('[data-action$="children"]')?void room_operations.setChildren(a):void 0}),$('a[data-action="search_container_toggler"]').click(function(){var a=_getSearchForm(this),b=$(a).find('[data-action="search_container_rooms"]');return $(this).hide(),b.show(),!1})}),$(document).ready(function(){$('ul[data-action="tabs"] > li a').on("click",function(){if($(this).is('[href^="#"]')||$(this).is("[data-tab]")&&!$(this).closest("li").hasClass("active")){var a=$(this).closest('ul[data-action="tabs"]');$(a).find("> li").removeClass("active"),$(this).closest("li").addClass("active");var b="";return $(this).is("[data-tab]")?b=$(this).attr("data-tab"):$(this).is('[href^="#"]')&&(b=$(this).attr("href").substring(1)),$('div[data-action="tabs"][data-tabs="'+$(a).attr("data-tabs")+'"]').hide(0),$('div[data-action="tabs"][data-tabs="'+$(a).attr("data-tabs")+'"][id="'+b+'"]').show(0,function(){$(this).is("[data-tabs-callback]")&&callByName($(this).attr("data-tabs-callback"))}),!1}}),$('ul[data-action="tabs"]').each(function(a,b){$(b).find("a:first").trigger("click")})}),$(document).ready(function(){$('[data-action="transfer_form"] #inp_transfer_date').datepicker({dateFormat:"dd.mm.yy",minDate:0,maxDate:"+1y",clearBtn:!0,autoclose:!0,altField:'[data-action="transfer_form"] #inp_transfer_date_alt',altFormat:"yy-mm-dd"}),$('[data-action="transfer_form"] select[data-select="geo"]').change(function(){var a=$(this).find("option:selected"),b=$(this).closest("fieldset").find('[data-action="geo_text_wrapper"]');if($(a).is('[data-type="city"]')?($(b).find('input[data-action="autocomplete"]').attr("data-autocomplete-filter","city="+$(a).val()),$(b).show()):$(b).hide(),$(a).is('[data-action="changer"]')){var c=$('[data-action="transfer_form"] select[data-select="geo"]').not(this);$(c).find("option:selected").is('[data-action="changer"]')&&($(c).find("option").removeProp("selected"),$(c).find("option:eq(1)").prop("selected",!0),$(c).trigger("change")),transferSetDirectionLabels()}}),$('[data-action="transfer_form"] [data-action="transfer-price"]').change(function(){var a=new Object;$('[data-action="transfer-price"]').each(function(b,c){return""==$(c).val()?(a=null,!1):void($(c).attr("name")&&(a[$(c).attr("name")]=$(c).val()))}),$("#transferPrice").hide(),$("#transferNoPrice").hide(),null!==a&&$.getJSON(window.transfer_price_link,a,function(a){a===!1?$("#transferNoPrice").show():($("#transferPrice > span").text(a),$("#transferPrice").show())})}).trigger("change"),transferSetDirectionLabels()});